TeXインストーラ3 0.85

(C)Abe Noriyuki abenori@math.sci.hokudai.ac.jp
                http://www.math.sci.hokudai.ac.jp/~abenori/

★始めに
初心者には難解な気がするWindows用TeXのインストーラです．
以下をインストールします．一部だけのインストールも可能です．
・角藤さんによるW32TeX
・dviout for Windows
・Ghostscript（8.11以降）
・GSview
・その他関係するソフト等
モットーは，「誰でもインストール出来るTeX」です．


★使用法
●インターネットに接続した状態で起動して「次へ」を押し続ければ自動的にインストールされると思います．たまに失敗しますが．
尚，FTP + Proxyの環境では現在使用出来ません．Proxyのない環境で使うかHTTPを使うかしてください．ごめんなさい．

●インストール後にGSviewを起動し（スタート→プログラム→Ghostgum→gsview **.**），Options→Advanced Configureと選びます．出てきた「Ghostscript Options」の欄に，
 -dWINKANJI
と後ろに追加してください．（頭に一つ空白が必要．）


★失敗した場合
たまに失敗します．

●最後に「失敗」の文字がでてきた場合
あわてず落ち着いて以下の手順を実行してください．
１．再起動が要求されてる場合，再起動します．
２．実行ファイルと同じディレクトリ内（設定によってはインストールディレクトリ/保存ディレクトリ/デスクトップのどこか）のabtexinst_log.txt（環境によってはabtexinst_log）を開きます．
３．具体的に何が失敗したか書かれているので，それをもとに「インストールファイルの選択」画面で，失敗したものにチェックを入れ，再度ダウンロードとインストールを行います．

●途中で失敗した旨が出る場合
以下のような方法で対処できるかもしれません．
・接続先を変更してみる．
・寝て起きてまた試してみる．

●解凍に失敗している場合
・ダウンロードしたフォルダのfilelistというフォルダ内にtar.exeの出力があります．参考になるかもしれません．

●最後の画面がでない場合
本来は最後にインストールの結果が表示されるはずなのですが，表示されないことがあります．とりあえず気にせずにいても大丈夫そうです．

★動作環境
Microsoft Windows XP/Vista/7/8/8.1 + httpまたはftpの繋がってる環境で動くと思います．

・Microsoft Windows 8.1 Pro + Internet Explorer 11

で動作を確認している可能性があります．


★アンインストール
TeXインストーラ3自体は本体，pluginフォルダ（中身含），及び生成されたabtexinst.iniとabtexinst_log.txtを削除するだけです．また，ダウンロードしたファイルも削除する必要があります．インストールされたアプリケーションはそれぞれの方法にのっとってアンインストールする必要があります．

●W32TeX
インストールフォルダ内のbinフォルダとshareフォルダを削除するだけです．デフォルトではc:\w32tex\binとc:\w32tex\shareになります．一応環境変数PATHに追加されたbinフォルダが残りますが，実害がないので残しておいてもいいでしょう．わかる人で気持ち悪い人は消してください．わからない人は無視してください．

●dviout for Windows
dvioutを起動し，Option→Uninstallを選んでアンインストールしてください．その後DVIOUTをインストールしたフォルダを削除すればOKです．

●Ghostscript, GSview
「コントロールパネル」→「アプリケーションの追加と削除」から削除出来ます．以下を削除してください（???は適当な文字列，***はバージョン番号）．
・??? Ghostscript ***
・??? Ghostscript Fonts（ないかもしれない）
・GSview ***
気持ち悪い人は環境変数PATHに追加されたGhostscriptフォルダを削除してください（わからない人は無視してください．）．


★手動インストール方法
下記参考URLのTeX Wiki内該当ページをご覧頂くのがわかりやすくていいと思います．


★参考URL
●アプリケーション
・W32TeX
角藤さんのWindowsに移植されたpTeXであるW32TeXのページです．
http://w32tex.org/index-ja.html

・dviout開発室
大島先生のdviout for Windowsのページです．
http://akagi.ms.u-tokyo.ac.jp/dvitest.html

・Ghostscript,Ghostview and GSview （英語）
Ghostscriptの公式ページです（多分）．
http://www.cs.wisc.edu/~ghost/

●TeXに関する情報ページ
・TeX Wiki
奥村さんのTeXに関するWikiです．掲示板(TeX Q & A / TeX Forum)にて活発に議論がなされています．
http://oku.edu.mie-u.ac.jp/~okumura/texwiki/

・TeXインストールガイド
トニイさんのページのコンテンツ．元々niftyのフォーラムにあったのですが，閉鎖にともない移転したようです．インストールに関して非常に丁寧な説明があります．
http://www.nsknet.or.jp/~tony/TeX/install/index.htm


★謝辞
●中国語リソース（lang\2052.dll）はMaQiYuan氏に作っていただきました．

●zip解凍部分にはzlib version 1.2.3を使っています．
Copyright (C) 1995-2005 Jean-loup Gailly and Mark Adler
http://www.zlib.net/

●Ruby1.8.7を組み込んでいます．
http://www.ruby-lang.org/ja/

●正規表現には鬼車5.9.1を利用しています．
(c) K.Kosako http://www.geocities.jp/kosako3/oniguruma/

●以前にはHmJreを用いた正規表現によって内部コードを簡易化していました．
Copyright (C) 2003-2004 有限会社サイトー企画
http://hide.maruo.co.jp/software/hmjre.html


★ライセンス
本体には修正BSDライセンスが適用されます．利用している各ライブラリには，各々のライセンスが適用されます．（license.txt参照．）


★連絡先 （要望，バグ報告などはこちらまで）
阿部 紀行（あべ のりゆき）
abenori@math.sci.hokudai.ac.jp
http://www.math.sci.hokudai.ac.jp/~abenori/


★開発環境
・Microsoft Windows 8.1 Pro
・Microsoft Visual Studio 2013 Express for Windows Desktop


★履歴
●0.01β1(2003/11/6)
・kakuto.exeのユーザインターフェースを見直し新しく初心者向けに出発．
●0.01β2(2003/11/29)
・環境変数TMPやTEMPに日本語が入ってた場合一時的に勝手に書き換え．
・dviout,Ghostscript,GSviewがインストールされてる時にアンインストールを問い合わせる．
・dvioutのインストールを自前で行うようにした．
・TeXのインストール時のコマンドプロンプトを開かないようにした．
・ダウンロードしてないファイルもインストール出来るようにした(W32TeX)．
●0.01β3(2003/12/05)
・内部HmJreを1.03に置き換え．
●0.01β4(2003/12/14)
・proxy設定を無視していたバグ修正．
●0.01β5(2003/12/22)
・logファイルを作成するようにした．
・GSviewのデフォルトでのURLをftp://ftp.u-aizu.ac.jp/pub/tex/CTAN/support/ghostscript/ghostgum/に変更．
・使用zlibをversion 1.14からversion 1.21に変更．
●0.01β6(2004/1/8)
・ダウンロード時にproxy設定がされなかった（IEのデフォルトを使用していた）のを修正．
●0.01β7(2004/1/22)
・HmJreをversion 1.06に差し替え．
●0.01β8(2004/2/18)
・texinst752がotfかotfdevelのどちらかしか解凍しなくなったので併せてotfしかダウンロード＆解凍しないようにした．
●0.01β9(2004/5/17)
・HmJreをversion 1.10に差し替え．
・他ささやかな修正．
●0.01β10(2004/9/5)
・Ghostscriptのインストールディレクトリ推定をUninstallStringからにした．
・奥村先生のページのリンクを修正．
●0.01β11(2004/9/26)
・HmJreをversion 1.12に差し替え．
・ウィンドウ関連処理を少し改良．
●0.01β12
・キャッシュを削除してからダウンロードを出来るようにした．
・バージョン情報が0.001になっていたのを修正．
●0.01β13(2004/10/27)
・FTP + Proxyが使えないことが発覚したのでその旨を書き込み（頑張ってそのうちサポートします．）．
・ソース整理．
●0.01β14(2004/11/09)
・kakuto3.logに書き込まれるログを詳細にした．
・kakuto3.logを上書きしないようにした．
・環境変数チェックを追加．
・Ghostscriptの場所をPATHに追加するようにした．
●0.01β15(2004/11/10)
・autoexec.batへの書き込みを改良．
●0.01(2004/12/01)
・正式版．
・ドラクエ８クリア版（謎）．
・メモリリークのバグ修正．
●0.01r1(2004/12/07)
・再起動が促されないバグ修正．
・dvioutのフォントパスにshare\texmf-local\fontを入れるようにした．
●0.01r2(2005/01/06)
・dvioutのTEXROOTにわけのわからない文字が混入するバグ修正．
・niftyフォーラムの閉鎖にともない，参考URLをトニイさんのサイトに変更．
●0.02(2005/01/26)
・plugin実装．とりあえずjsclass用を用意．
・dviout,Ghostscript,GSviewのタイムスタンプチェックを追加．
・ユーザ環境変数も削除するように．
・ネットワークを使わないインストール．
・NT系でインストール後，PATHが正常に展開されなくなるバグ修正（mkasaさんthanks！）．
・環境変数とかが長すぎる時にも読み込めるようにした．
・その他細かい修正．
●0.02r1(2005/01/30)
・dvioutのgsxに都合の悪い値が入るバグ修正．
●0.02r2(2005/02/13)
・Ghostscriptのインストールディレクトリに空白が入ってた場合，正常にPATHが設定されないバグ修正．
●0.03(2005/02/18)
・dvioutのアップデートに対応．（既にあるレジストリは上書きしない．）
・gsxに書き込む値をパスのみにした．
●0.10(2005/03/06)
・ローカルからのインストール時に，最新のtexinst***から情報を取得するようにした．
・保存ディレクトリまたはインストールディレクトリに空白または全角文字が入ってた場合，設定のし直しをさせるようにした．
・0.1にしてみた（いい加減なバージョン番号）．
●0.11(2005/03/07)
・落ちるバグ修正．
●0.12(2005/03/09)
・jsclasses pluginで落ちるバグ修正．
●0.20(2005/04/10)
・pluginの仕様拡張（今後への布石？）．
・jsclasses pluginをそれに併せて改良．
・最終画面が後ろに行きがちなのを修正．
●0.21(2005/04/12)
・ネットワークを使わないインストールで，pluginが無視されるバグ修正．
・plugin仕様にIsNeedRebootを追加．
・zip解凍をpluginでなくkakuto3が担当するようにした．
・リソースのバージョンを変更し忘れてたのを修正．
●0.30(2005/04/18)
・pluginから更に担当部分をkakuto3に移行．その他いくつか関数をkakuto3からエクスポート．
・ログファイルの時間がロンドン時間になってたのを修正．
・xy-pic用pluginを追加（別の配布にします．）．
・jsclasses pluginのエラーチェック強化．
●0.31(2005/05/06)
・エクスポート関数の名称一部変更．
・エクスポート関数SETSYSTEMENVを追加．
・ispell pluginの追加（別配布）
●0.32(2005/05/13)
・接続先のデフォルトをakagiからringに変更（混雑緩和の為）．
・ログファイル名をkakuto3.logからkakuto3_log.txtに変更．
●0.33(2005/05/22)
・いくつかの自明なミスの修正．
・エラーメッセージを詳細にしてみた……つもり．
・エラー対策を少し入れてみた……つもり．
・ローカルファイルが最新と判定されやすくなった．（ローカルが古くても，その差が三日以内ならローカルが新しいと判断する．）
●0.34(2005/05/25)
・ローカルからのインストール時に落ちるバグ修正．
●0.40(2005/09.11)
・SETUSERENV追加．
・PATHの設定方法を少し変えた．
・情報取得方法を変更．ファイル一覧を取得する際にタイムスタンプとサイズも取得するようにした．
・副作用（？）で，サイズの表示がKByteかMByte単位になった．
・解凍時，kakuto3本体がCPUをかなり占有していたのを修正．
・残り時間の表示．正確に表示できるといいね．
・dviout.defをコピーするようにした．多分．
・郵政選挙の日．
●0.41(2005/09/11)
・HTTPを使った場合時間がむちゃくちゃだったバグ修正．
・jsclassesとかで情報取得する時に何をやってるのか出なかったのを修正．
●0.42(2005/09/21)
・FTPで情報取得した場合，常に最新と判定されるバグ修正．
・URLリストにランダムringを追加．
●0.43(2005/10/26)
・TARDLGで解凍した時，tar.exeを使うとファイル名が正常に表示されないバグ修正．
・ダウンロードに失敗しても実行し続けることにした．
・jsclasses_pluginでProxy設定を無視してたバグ修正．
・Ghostscriptの設定（cidfmapへの書き込み）をしなくした．
・HTTPで10Mを越えるファイルをダウンロードした場合，残り時間の表示がおかしくなるバグ修正．
●0.44(2005/11/01)
・Ghostscriptが新規でインストールされないバグ修正．
●0.45(2005/11/25)
・デフォルト接続先を変更．
・Ghostscriptの設定をしないようにしたにも関わらず最後の画面に表示されるバグ修正．
●0.46(2006/06/23)
・開発環境をVS.NET 2005に変更．
・Ghostscriptの\libにもPATHを通すようにした．
●0.47(2006/08/29)
・ユーザ環境変数の設定がうまく行かないバグ修正．
●0.50(2006/10/17)
・9x系でスクロールがされないバグ修正．
・9x系でダウンロードしているファイルのファイルサイズが正常に表示されないバグ修正．
・一つのプラグインで複数のインストールが可能であるようにプラグインの仕様を変更．
・プラグインでRubyを使えるようにした．
・jsclassesプラグインをRubyで書き直し．
・Ghostscriptで一時的にTEMP/TMPを書き換える処理がうまく動いてないバグ修正．
●0.51(2006/11/21)
・RubyのGETINISTRで，INT2NUMを付け忘れていたバグ修正．
・HTTPの場合に，サイズの取得が上手くできていなかったバグ修正．
●0.52(2006/12/06)
・jsclassesがネットワークを使うかどうか無視していたのを修正．
●0.53(2006/12/09)
・0.52の修正が全然ダメだったのを修正．
●0.54(2006/12/16)
・Rubyが0をfalseと扱わないなんて聞いてません．
●0.55(2007/02/06)
・W32TeXのチェックを全て外すボタンを追加．
●0.56(2007/02/07)
・tarの戻り値は2も許可することにした．
・dvioutのスタートメニューへの登録をAllUserから各ユーザに変更．
・9x系でスタートメニューの取得ができてなかったバグ修正．
・GetDownloadDataの仕様変更．ソフト名を受け付けなければならなくなった．
●0.57(2007/02/09)
・標準出力を閉じてしまったせいでtar.exeが動かなくなっていたバグ修正．
●0.58(2007/03/25)
・Rubyライブラリのtk関連を外してみた．
・GhostscriptがAFPL限定になっていたのを修正．
・Rubyプラグインが例外を発生させた時，ruby_errinfo.to_sをログにはき出すようにした．
●0.59(2007/05/18)
・GPL Ghostscriptも補足できるようにした．
●0.60(2007/08/05)
・W32TeXがptexを消したことに対する更新（jsclasses）．
・Ghostscriptの「Use Windows TrueType fonts for……」に勝手にチェックを入れるようにしてみた．
・Ghostscriptアンインストール時にlibフォルダをPATHから消していなかったのを修正．
●0.70(2008/02/16)
・64bit OS上ではGSviewの64bit版を表示するようにしてみた．
・システム設定（Internet Explorerの設定）を用いるを追加．
・キャンセルやタイムアウトの強化．
・前回キャンセルされた場合でも，続きから行われるようにした．
・W32TeXは，すでにインストールされていればアンインストールするようした．
●0.71(2008/05/08)
・プラグインだと，IEの設定が使われていないバグ修正．
●0.72(2008/08/22)
・Ghostscript 8.63のパス設定が失敗するのに対処．
●0.73(2009/08/08)
・一時配布元がw32tex.orgに変わったのにあわせて，HTTP関連の処理を改良/w32tex.orgに対応．
●0.74(2009/08/20)
・W32TeX以外もファイルサイズを表示するようにした．
・0.33で入れたローカルファイルが最新と判定されやすくなるルーチンが実は機能していなかったのを修正．
・正規表現エンジンを鬼車に変更．
・zlibを1.2.3にした．
・Rubyを1.8.7にした．
●0.75(2009/09/12)
・（多分）ローカルからのインストールがうまく言っていなかったのを修正．
・jsclassesプラグインをRubyのからdllのに戻した．
・ライセンスを変更．
●0.76(2009/09/11)
・jsclassesがptexディレクトリにインストールされてしまうバグの修正．
●0.80(2010/05/23)
・設定情報を内部に保持し，終了時にファイルに書き出すようにした．
・[system]NoWriteINIが0ならば設定ファイルに情報を書き込まないようにした．
・[system]NoWriteHozonDirが0ならばファイルを保存するフォルダ以下への書き込みを行わないようにした．
・プラグイン仕様の変更．（関数名，引数，戻り値仕様を変更．）
・ファイル名をkakuto3.exeからabtexinst.exeに変更．（その他いくつかのファイル名を変更．）
・併せて，RubyプラグインのKakuto3モジュールもAbTeXinstモジュールに．
・基本的な設定を取得するために，AbTeXinst::Settingモジュールとその下の各種関数を追加．
・dllプラグインにも同様の変更．
・ファイルの保存先が相対パスに対応．
・ファイルの保存先/インストール先が環境変数に対応．（読み込み時に展開する．）
・これらにより，abtexinst.exe単体でインストールCDが作れるようになったと思うので，ドキュメントらしきものを書いた．
・texinst/Ghostscriptの解凍場所を一時ディレクトリに変更．
・zip/tarの解凍時の画面をちょっと変更した．
・GSviewのデフォルトダウンロード先を理化学研究所のサーバにした．
●0.81(2010/06/02)
・otf/otfdevel/otfbeta，xetex-w32/xetex-dev-w32，luatex-w32/luatex-dev-w32から選んでインストールできるようにした．
・ログファイルの保存先をいじれるようにした．
・デフォルトのインストール先をw32texにした．
●0.81r1(2010/06/20)
・UACが動くようにした．
・たくさんのタイポを修正．
・ログ吐き出し周りを調整とか．
●0.81r2(2010/08/07)
・tarでの解凍の時にディレクトリを作成するようにした．
・そのせいでispellプラグインが機能していなかったのが直った．
・何故かログが作成されなかったりするのが直った気がする．
●0.81r3(2010/12/17)
・xz形式に対応．
●0.81r4(2011/03/13)
・Ruby-mswin32をruby 1.8.7 (2010-12-23 patchlevel 330)にした．
●0.81r5(2011/04/21)
・Ruby内で環境変数HOMEが書き換えられているのをキャンセルする処理を入れた．
・xetex-dev-w32がなくなったことに対する修正．
・w32tex.orgでの配布が中止になったことに対する修正．
●0.81r6(2011/05/01)
・w32tex.orgにてGhostscriptの配布も廃止されたことに対する修正．
・URLリストを再編成．ringを中心とした構成にした．デフォルトをdvioutはftp://akagi.ms.u-tokyo.ac.jp/，他をhttp://www.ring.gr.jp/とする．
●0.81r7(2011/06/28)
・TENBIN廃止に伴い，(www|ftp).t.ring.gr.jpを削除．
・core.ring.gr.jpを一覧に追加．
●0.82(2012/03/31)
・share\texmf\ls-Rが存在する場合，mktexlsrを実行するようにした．
・開発環境をVC++ 2010 Expressにした．
・VisualuRubyを同封．
・dir_inputの引数の数を間違えていて動いていなかったのを修正．
・dir_inputの失敗時はnilを返すことにした．
・beginthreadで作成したスレッド内からRuby APIを呼び出していたため，GC周りのエラーが起きることがあったのを修正．
・ダウンロード/インストール中にキャンセルされたら戻るようにした．
・Rubyプラグインに対して，AbTeXinst::register_pluginによるプラグインの登録を実装（今後はこちらが推奨）．
・終了直前にPluginUnInit（DLLプラグイン），plugin_uninit（Rubyプラグイン）が呼び出されるようになった．
・TeXworks.rbを一緒に入れることにした．
・abtexinst.txtをreadme.txtに改名．
●0.82r1(2012/04/03)
・Ghostscript 9.05を入れたときに，PATHが正しく設定されないバグ修正．
●0.83(2012/04/09)
・設定ファイルをabtexinst.iniとabtexinst_sys.iniに分割．
・配布ファイルにabtexinst_sys.iniを追加．
・URLリストの設定ファイルへの追い出しをした．
・「似たようなファイルのリスト」の設定ファイルへの追い出しをした．
・Ghostscript 9.05をアンインストールしたときに，PATHが削除されないバグ修正．
●0.84(2013/03/07)
・内部をだいたいUNICODEにした．
・lang以下にほかの言語のリソースをDLLとしておいておくと，システムの言語設定に応じてそれを使うようにした．
・中国語用のリソースDLLを入れてみた．
・Rubyプラグイン用関数「update_lsr」を追加．
・tar.exeのエラーチェックを強化．
・HTTP経由のファイルリスト取得ルーチンを強化．
・GSviewのURLをhttp://pages.cs.wisc.edu/~ghost/gsview/download/のみにした．（CTANでの配布がなくなったため．）
●0.84r1(2013/05/11)
・texmf→texmf-distになったので対処．
・ダウンロードに失敗してもインストールをしようとするのを修正．
・ダウンロードの時にproxyがまともに設定されないのを対処．（多分Wininet.hのバグ．）
・TeXworksのインストールのフォント設定を最新のにした．
・Rubyから呼べるAbTeXinst::message_boxとAbTeXinst::question_boxを追加．
●0.84r2(2013/05/27)
・dvioutのFont/TEXROOTがおかしかったのを直した．
・zipによるファイル解凍時にファイル名がでないのを修正．
・dviout.defがコピーできなかったのを修正．
●0,84r3(2013/07/05)
・dviout.defのコピーをやめた．
●0.84r4(2013/07/17)
・win64以下のファイルもインストールするようにした．
●0.84r5(2013/07/22)
・W32TeXのインストールをftpで試みると失敗するのを修正．
・luatex-w64とluatex-w64-devはどちらか一方のみを表示することにした．（abtexinst.iniを一度削除する必要がある．）
●0,84r6(2013/07.25)
・XPで動かなかったのを修正．（開発環境の変化による影響．）
●0.85(2015/07/11)
・ネットワークを使わない時もwin64以下のファイルもインストールするようにした．
・デフォルトのRingサーバをdnsbalanceに変更．
・mktexlsrに失敗することがあったのを修正．
●085r1(2015/09/11)
・luajittex-w32.tar.xzとluajittex-dev-w32.tar.xzが同時にインストールされてしまうのを直した．w64も同様．
・TeXworks.rbの和文フォントを最新のものにあわせた．
